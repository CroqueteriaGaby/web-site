npx lint-staged

# Changelog enforcement: if source files changed, CHANGELOG.md must also change
CHANGED=$(git diff --cached --name-only)
SRC_CHANGED=$(echo "$CHANGED" | grep -E '^src/|^package\.json' | head -1)
CHANGELOG_CHANGED=$(echo "$CHANGED" | grep 'CHANGELOG.md')

if [ -n "$SRC_CHANGED" ] && [ -z "$CHANGELOG_CHANGED" ]; then
  echo ""
  echo "ERROR: Source files changed but CHANGELOG.md was not updated."
  echo "Please add a changelog entry describing your changes."
  echo "Skip with --no-verify for formatting-only changes."
  echo ""
  exit 1
fi
